<!-- index.html -->
<html>
	<head>
		<link rel="stylesheet" href="CSS/style.css" />
		<script src="JS/app.js"></script>
	</head>
<body>
	<!-- Display a loading screen until media is ready -->
	<div id="loading" class="loading">

		<h1>Content Loading</h1>
	</div>

	<!-- 
	All(?) animations should be contained within the svg-container in order to keep them in the same coordinate system and on the same animation timeline
	-->
	<svg id="svg-container" width="100%" height="100%" viewBox="0 0 100 50" xmlns="http://www.w3.org/2000/svg">

		<!-- 
			#bg-rect is what we will bind the wind properties to
		-->
		<rect id="bg-rect" x="0" y="0" width="100%" height="100%" style="filter: url(#noise1); z-index: -10;" />
<!-- Bird circles -->
  
<circle class="bird" id=2847 r="1.694" fill="#544B32" cx="35.333333333333336" cy="12.693999999999999" />
<circle class="bird" id=2848 r="1.088" fill="#544B32" cx="40.333333333333336" cy="33.088" />
<circle class="bird" id=2856 r="2" fill="#D7D1C4" cx="71.66666666666667" cy="12" />
<circle class="bird" id=2859 r="1.272" fill="#D7D1C4" cx="72.39466666666667" cy="18.272" />
<circle class="bird" id=2864 r="2" fill="#847653" cx="52.333333333333336" cy="10" />
<circle class="bird" id=2884 r="0.296" fill="#847653" cx="90.37066666666666" cy="13.296" />
<circle class="bird" id=2889 r="1.132" fill="#544B32" cx="58.333333333333336" cy="43.132000000000005" />
<circle class="bird" id=2892 r="0.356" fill="#847653" cx="62.333333333333336" cy="40.356" />
<circle class="bird" id=2894 r="1.448" fill="#D7D1C4" cx="71.21866666666668" cy="4.448" />
<circle class="bird" id=2906 r="0.25" fill="#847653" cx="52.333333333333336" cy="8.25" />
<circle class="bird" id=2913 r="0.25" fill="#544B32" cx="35.333333333333336" cy="43.25" />
<circle class="bird" id=2915 r="1.076" fill="#544B32" cx="40.333333333333336" cy="33.076" />
<circle class="bird" id=2922 r="0.25" fill="#544B32" cx="55.333333333333336" cy="33.25" />
<circle class="bird" id=2924 r="0.25" fill="#D7D1C4" cx="49.333333333333336" cy="18.25" />
<circle class="bird" id=2925 r="0.25" fill="#544B32" cx="59.333333333333336" cy="34.25" />
<circle class="bird" id=2926 r="0.25" fill="#544B32" cx="52.333333333333336" cy="25.25" />
<circle class="bird" id=2933 r="0.25" fill="#544B32" cx="43.333333333333336" cy="4.25" />
<circle class="bird" id=2943 r="0.25" fill="#D7D1C4" cx="22" cy="20.25" />
<circle class="bird" id=2977 r="0.25" fill="#544B32" cx="51.333333333333336" cy="9.25" />
<circle class="bird" id=2986 r="0.25" fill="#544B32" cx="58.333333333333336" cy="24.25" />
<circle class="bird" id=2987 r="0.25" fill="#D7D1C4" cx="18" cy="9.25" />
<circle class="bird" id=2993 r="0.25" fill="#544B32" cx="40.333333333333336" cy="41.25" />
<circle class="bird" id=3001 r="0.25" fill="#847653" cx="24" cy="14.25" />
<circle class="bird" id=3002 r="0.25" fill="#D7D1C4" cx="14" cy="18.25" />
<circle class="bird" id=3005 r="0.25" fill="#847653" cx="63.333333333333336" cy="1.25" />
<circle class="bird" id=3006 r="0.25" fill="#544B32" cx="37.333333333333336" cy="43.25" />
<circle class="bird" id=3007 r="0.25" fill="#D7D1C4" cx="8" cy="10.25" />
<circle class="bird" id=3018 r="0.25" fill="#544B32" cx="38.333333333333336" cy="30.25" />
<circle class="bird" id=3020 r="0.25" fill="#847653" cx="48.333333333333336" cy="32.25" />
<circle class="bird" id=3023 r="0.616" fill="#D7D1C4" cx="64.33333333333334" cy="40.616" />
<circle class="bird" id=3025 r="0.63" fill="#D7D1C4" cx="39.333333333333336" cy="13.629999999999999" />
<circle class="bird" id=3026 r="0.522" fill="#847653" cx="62.333333333333336" cy="40.522" />
<circle class="bird" id=3027 r="0.334" fill="#544B32" cx="60.333333333333336" cy="36.334" />
<circle class="bird" id=3028 r="2" fill="#544B32" cx="47.333333333333336" cy="35" />
<circle class="bird" id=3029 r="1.264" fill="#847653" cx="59.333333333333336" cy="40.263999999999996" />
<circle class="bird" id=3030 r="0.868" fill="#544B32" cx="18" cy="22.868" />
<circle class="bird" id=3059 r="2" fill="#544B32" cx="56.333333333333336" cy="35" />
<circle class="bird" id=3091 r="2" fill="#D7D1C4" cx="49.333333333333336" cy="4" />
<circle class="bird" id=3113 r="0.25" fill="#847653" cx="60.333333333333336" cy="23.25" />
<circle class="bird" id=3117 r="0.35" fill="#D7D1C4" cx="38.333333333333336" cy="4.35" />
<circle class="bird" id=3120 r="2" fill="#D7D1C4" cx="28" cy="15" />
<circle class="bird" id=3122 r="0.602" fill="#D7D1C4" cx="30" cy="10.602" />
<circle class="bird" id=3124 r="1.78" fill="#D7D1C4" cx="60.333333333333336" cy="23.78" />
<circle class="bird" id=3162 r="0.25" fill="#D7D1C4" cx="7" cy="3.25" />
<circle class="bird" id=4915 r="0.25" fill="#544B32" cx="98.41666666666667" cy="8.25" />

	  <!-- Define an eliptical arc for the Wheel to follow
		M 2,50: 'move' to bottom left to start drawing
		A 50,50: Follow an eliptical arc with radii 50,50 (hence a circle)
		0 0 1: Follow the positive path of the elipse
		98,50: End at the bottom right 

	   --> 
	 <path id="arc" d="M 2,50 A 50,50 0 0 1 98,50"  />
	 
	  <!-- Define a group for the wheel image; reposition left and up by the radius (12) -->
	  <g id="wheel-group" transform="translate(-12, -12)" >

		 <!-- Hide the wheel until data is loaded. This is probably unneccessary since it does 
		 	not solve the Safari bug -->	  	
		  <image id="wheel" class="hide" width="24" height="24"  xlink:href="SVG/ring.svg" >

		  <!-- Use animateMotion to move the image along the path -->
		  <!-- Here's what the properties mean:
		  	repeatCount -- How many times to repead the animation. change to 'indefinite' if we want to auto-loop
		  	dur -- 24 minute duration to sync with audio
		  	keyPoints -- start the animation a 10% (.1) and end at 90% (.9)
		  	keyTimes -- time 0 corresponds to keypoint .1; time 1 to keyPoint .9
		  	calcMode -- linear interpolation is the default
		  	fill -- "Freeze" the animation when it is finished
		  	begin -- start at second 0.

		  -->
		  <animateMotion id="motion" 
			  repeatCount="0" 
			  dur="24min" 
			  keyPoints="0.1;0.9"
		      keyTimes="0;1"
		      calcMode="linear" 
		      fill="freeze"
		      begin="0s"
		      >
		      <!-- reference to the 'arc' path we will follow -->
		    <mpath href="#arc" />
		    
		  </animateMotion>

		  <!-- Use animateTransform to rotate the image. 
		  	We rotate from 37ยบ to -205ยบ in order to get the start and end positions correct.
		  -->
		  <animateTransform id="rotation" attributeName="transform" attributeType="XML" type="rotate" 
			from="37 12 12" to="-205 12 12" dur="24min" repeatCount="0" fill="freeze"
			begin="0s"
		   />
		</image>
	</g>

	<!-- use a polygon to make the marker. It's a bitch to position! -->
	<polygon id="pointer" points="0,0 0,2 2,2" transform="rotate(45) translate(-.6,-1.5)">
		<!-- animate the pointer along the same arc as the wheel -->
		<animateMotion id="pointer-arc" 
			  repeatCount="0" 
			  dur="24min" 
			  keyPoints="0.2;1"
		      keyTimes="0;1"
		      calcMode="linear" 
		      fill="freeze"
		      rotate="auto"
		      begin="0s"
		      >
		    <mpath href="#arc" />
	</polygon>
	  <filter id="noise1" x="0" y="0" width="100%" height="100%">
    <feTurbulence id="wind" type="fractalNoise" baseFrequency="0.02 0.1" numOctaves="5" result="noise" />
    <feDiffuseLighting id='light' in='noise' lighting-color='white' surfaceScale='3'>
            <feDistantLight id="light-angle" azimuth='45' elevation='60' />
    </feDiffuseLighting>
    
    
    <animate xlink:href="#wind" attributeName="baseFrequency" dur="20s" 
        values="0.01 0.03; 
                0.002  0.034;
                
                

                0.01 0.033; 
                0.005  0.03;
                
                "
         keyTimes="0;.5; 
				          .501;1
         "
         
                
        repeatCount="indefinite" />
        <!-- values="0.01 0.05; 
                0.0071  0.03" -->
    <animate xlink:href="#light" attributeName="surfaceScale" dur="10s" values=".5; 4; 5; .5"
					   keyTimes="0; .2; .8; 1"
             repeatCount="indefinite" />
    <animate xlink:href="#light" attributeName="lighting-color" dur="24min" 
        values="#D6D6E8; 
        #D6D6E8; 
        #D6D6E8; 
        #CEE0F3; 
        #CEE0F3; 
        #FEF9E5; 
        #FEF9E5; 
        #FBE7D9; 
        #FBE7D9; 
        #FEF9E5; 
        #E4F1ED; 
        #CEE0F3; 
        #D6D6E8;"
    />
    

    
  </filter>
</svg>

<!-- The browser-default HTMLMediaElement for audio controls. Replace with custom -->
<figure id="au-control">
  <audio id="audio" controls 
  	src="https://dickinsonsbirds.org/Year_V2_1864_Soundscape.mp3"
  	autoplay	 
  	onseeked="doSeek(event)"
  	onplay="doPlay(event)"
  	onpause="doPause(event)"
  	oncanplaythrough="doLoaded(event)">
    
  </audio>
</figure>
<script>
	document.getElementById('svg-container').pauseAnimations();
</script>
</body>


</html>